(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-42de97a9"],{"5fed":function(e,t,r){"use strict";r.r(t);var n=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"app-container"},[r("el-button",{attrs:{type:"primary"},on:{click:e.handleAddRole}},[e._v("New Role")]),e._v(" "),r("el-table",{staticStyle:{width:"100%","margin-top":"30px"},attrs:{data:e.rolesList,border:""}},[r("el-table-column",{attrs:{align:"center",label:"Role Code",width:"220"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n        "+e._s(t.row.code)+"\n      ")]}}])}),e._v(" "),r("el-table-column",{attrs:{align:"center",label:"Role Name",width:"220"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n        "+e._s(t.row.name)+"\n      ")]}}])}),e._v(" "),r("el-table-column",{attrs:{align:"header-center",label:"Description"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n        "+e._s(t.row.description)+"\n      ")]}}])}),e._v(" "),r("el-table-column",{attrs:{align:"center",label:"Operations"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(r){return e.handleEdit(t)}}},[e._v("Edit")]),e._v(" "),r("el-button",{attrs:{type:"danger",size:"small"},on:{click:function(r){return e.handleDelete(t)}}},[e._v("Delete")])]}}])})],1),e._v(" "),r("el-dialog",{attrs:{visible:e.dialogVisible,title:"edit"===e.dialogType?"Edit Role":"New Role"},on:{"update:visible":function(t){e.dialogVisible=t}}},[r("el-form",{attrs:{model:e.role,"label-width":"80px","label-position":"left"}},[r("el-form-item",{attrs:{label:"Name"}},[r("el-input",{attrs:{placeholder:"Role Name"},model:{value:e.role.name,callback:function(t){e.$set(e.role,"name",t)},expression:"role.name"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"Code"}},[r("el-input",{attrs:{placeholder:"Role Code"},model:{value:e.role.code,callback:function(t){e.$set(e.role,"code",t)},expression:"role.code"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"Desc"}},[r("el-input",{attrs:{autosize:{minRows:2,maxRows:4},type:"textarea",placeholder:"Role Description"},model:{value:e.role.description,callback:function(t){e.$set(e.role,"description",t)},expression:"role.description"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"Menus"}},[r("el-tree",{ref:"tree",staticClass:"permission-tree",attrs:{"check-strictly":e.checkStrictly,data:e.routesData,props:e.defaultProps,"show-checkbox":"","node-key":"id"}})],1)],1),e._v(" "),r("div",{staticStyle:{"text-align":"right"}},[r("el-button",{attrs:{type:"danger"},on:{click:function(t){e.dialogVisible=!1}}},[e._v("Cancel")]),e._v(" "),r("el-button",{attrs:{type:"primary"},on:{click:e.confirmRole}},[e._v("Confirm")])],1)],1)],1)},i=[],a=r("75fc"),o=(r("6762"),r("2fdb"),r("ac4d"),r("8a81"),r("ac6a"),r("96cf"),r("3b8d")),l=r("ed08"),c=r("cc5e"),s=r("b775"),u="/menu";function d(){return Object(s["a"])({url:u,method:"get"})}var h={key:"",name:"",description:"",menus:[]},f={name:"Permission",data:function(){return{role:Object.assign({},h),routes:[],rolesList:[],dialogVisible:!1,dialogType:"new",checkStrictly:!1,defaultProps:{children:"children",label:"title"}}},computed:{routesData:function(){return this.routes}},created:function(){this.getAllMenu(),this.getAllRole()},methods:{getAllMenu:function(){var e=Object(o["a"])(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,d();case 2:t=e.sent,this.serviceRoutes=Object(l["c"])(t.data),this.routes=t.data;case 5:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}(),getAllRole:function(){var e=Object(o["a"])(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(c["c"])();case 2:t=e.sent,this.rolesList=t.data;case 4:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}(),handleAddRole:function(){this.role=Object.assign({},h),this.$refs.tree&&this.$refs.tree.setCheckedNodes([]),this.dialogType="new",this.dialogVisible=!0},handleEdit:function(e){var t=this;this.dialogType="edit",this.dialogVisible=!0,this.checkStrictly=!0,this.role=Object(l["c"])(e.row),this.$nextTick(function(){var e=t.role.menus;t.$refs.tree.setCheckedNodes(t.generateArr(e)),t.checkStrictly=!1})},confirmRole:function(){var e=Object(o["a"])(regeneratorRuntime.mark(function e(){var t,r;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(t="edit"===this.dialogType,r=this.$refs.tree.getCheckedKeys(),this.role.menus=this.generateTree(Object(l["c"])(this.serviceRoutes),r),!t){e.next=8;break}return e.next=6,Object(c["d"])(this.role);case 6:e.next=10;break;case 8:return e.next=10,Object(c["a"])(this.role);case 10:this.dialogVisible=!1,this.$message.success("succed!"),this.getAllRole();case 13:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}(),handleDelete:function(e){var t=this,r=(e.$index,e.row);this.$confirm("Confirm to remove the role?","Warning",{confirmButtonText:"Confirm",cancelButtonText:"Cancel",type:"warning"}).then(Object(o["a"])(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(c["b"])(r.id);case 2:t.$message.success("Delete succed!"),t.getAllRole();case 4:case"end":return e.stop()}},e)}))).catch(function(e){console.error(e)})},generateTree:function(e,t){var r=[],n=!0,i=!1,a=void 0;try{for(var o,l=e[Symbol.iterator]();!(n=(o=l.next()).done);n=!0){var c=o.value;c.children&&(c.children=this.generateTree(c.children,t)),t.includes(c.id)&&r.push(c)}}catch(s){i=!0,a=s}finally{try{n||null==l.return||l.return()}finally{if(i)throw a}}return r},generateArr:function(e){var t=this,r=[];return e.forEach(function(e){if(r.push(e),e.children){var n=t.generateArr(e.children);n.length>0&&(r=[].concat(Object(a["a"])(r),Object(a["a"])(n)))}}),r}}},p=f,m=r("2877"),b=Object(m["a"])(p,n,i,!1,null,"2a47170d",null);t["default"]=b.exports},cc5e:function(e,t,r){"use strict";r.d(t,"c",function(){return a}),r.d(t,"a",function(){return o}),r.d(t,"b",function(){return l}),r.d(t,"d",function(){return c});var n=r("b775"),i="/role";function a(){return Object(n["a"])({url:i,method:"get"})}function o(e){return Object(n["a"])({url:i,method:"post",data:e})}function l(e){return Object(n["a"])({url:i+"/".concat(e),method:"delete"})}function c(e){return Object(n["a"])({url:i,method:"put",data:e})}}}]);